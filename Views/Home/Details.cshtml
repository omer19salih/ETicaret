@using WebApplication2.Entity;
@model Product

@{
    ViewBag.Title = "Ürün Detayları";
}
<!-- Bootstrap CSS -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
<div id="product-details" class="container pb-5">
    <div class="row">
        <div class="col-md-6">
            <!-- Carousel -->
            <div id="productCarousel" class="carousel slide" data-ride="carousel">
                <ol class="carousel-indicators">
                    <li data-target="#productCarousel" data-slide-to="0" class="active"></li>
                    <li data-target="#productCarousel" data-slide-to="1"></li>
                    <li data-target="#productCarousel" data-slide-to="2"></li>
                    <!-- Daha fazla slide için li ekleyin -->
                </ol>
                <div class="carousel-inner">
                    <div class="carousel-item active">
                        <img src="/Upload/@Model.Image" class="d-block w-100" alt="Resim 1">
                    </div>
                    <div class="carousel-item">
                        <img src="/Upload/@Model.Image" class="d-block w-100" alt="Resim 2">
                    </div>
                    <div class="carousel-item">
                        <img src="/Upload/@Model.Image" class="d-block w-100" alt="Resim 3">
                    </div>
                    <!-- Daha fazla carousel-item ekleyin -->
                </div>
                <a class="carousel-control-prev" href="#productCarousel" role="button" data-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="sr-only">Önceki</span>
                </a>
                <a class="carousel-control-next" href="#productCarousel" role="button" data-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="sr-only">Sonraki</span>
                </a>
            </div>
        </div>
        <div class="col-md-6">
            <div class="row">
                <div class="col-md-12">
                    <h1>@Model.Name</h1>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12">

                    @if (Model.IsApproved)
                    {
                        <span class="badge badge-primary">Stokta</span>
                    }
                    else
                    {
                        <span class="badge badge-danger">Stokta Yok</span>
                    }

                    <span class="product-number">#2365656</span>
                </div>
            </div>
            <div class="row mt-2">
                <div class="col-md-12">
                    <div id="description" class="readmore">
                        @Model.Description
                    </div>
                </div>
            </div>
            <div class="row mt-3">
                <div class="col-md-4">
                    <i class="fa fa-star"></i>
                    <i class="fa fa-star"></i>
                    <i class="fa fa-star" aria-hidden="true"></i>
                    <i class="fa fa-star" aria-hidden="true"></i>
                    <i class="fa fa-star-half-o" aria-hidden="true"></i>
                    <span class="badge badge-success">53</span>
                </div>
                <div id="write-review" class="col-md-4">
                    <a href="#" data-toggle="modal" data-target="#reviewModal">
                        Yorum Yap
                    </a>
                </div>

                <!-- Modal for writing review -->
                <div class="modal fade" id="reviewModal" tabindex="-1" role="dialog" aria-labelledby="reviewModalLabel" aria-hidden="true">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="reviewModalLabel">Yorum Yaz</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <form id="reviewForm">
                                    <div class="form-group">
                                        <label for="firstName">İsminiz</label>
                                        <input type="text" class="form-control" id="firstName" placeholder="İsminizi buraya yazın...">
                                    </div>
                                    <div class="form-group">
                                        <label for="lastName">Soyisminiz</label>
                                        <input type="text" class="form-control" id="lastName" placeholder="Soyisminizi buraya yazın...">
                                    </div>
                                    <div class="form-group">
                                        <label for="reviewText">Yorumunuz</label>
                                        <textarea class="form-control" id="reviewText" rows="4" placeholder="Yorumunuzu buraya yazın..."></textarea>
                                    </div>
                                    <button type="submit" class="btn btn-primary">Gönder</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>


            </div>
            <div class="row mt-3">
                <div class="col-md-12">
                    <h4> <span>@Model.Price TL</span> </h4>
                </div>
            </div>
            <div class="row mt-2">
                <div class="col-md-12">

                    @using (Html.BeginForm("AddToCart", "Cart"))
                    {
                        @Html.HiddenFor(i => i.Id)
                        <button type="submit" class="btn btn-success">
                            <i class="fa fa-cart-plus" aria-hidden="true"></i>
                            Sepete Ekle
                        </button>
                    }

                </div>
            </div>
        </div>
    </div>
    <div class="row mt-3">
        <div class="col-md-12">
            <div class="bd-example bd-example-tabs">
                <ul class="nav nav-tabs mb-3" id="pills-tab" role="tablist">
                    <li class="nav-item">
                        <a class="nav-link active" id="pills-description-tab" data-toggle="pill" href="#pills-description" role="tab" aria-controls="pills-description" aria-expanded="true">Açıklama</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" id="pills-payment-tab" data-toggle="pill" href="#pills-payment" role="tab" aria-controls="pills-payment" aria-expanded="true">Ödeme Yöntemleri</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" id="pills-comment-tab" data-toggle="pill" href="#pills-comment" role="tab" aria-controls="pills-comment" aria-expanded="true">Yorumlar</a>
                    </li>
                </ul>
                <div class="tab-content" id="pills-tabContent">
                    <div class="tab-pane fade show active" id="pills-description" role="tabpanel" aria-labelledby="pills-description-tab">
                        <p>Ürün hakkında detaylı açıklama burada yer alacak. Ürünün özellikleri, kullanım talimatları ve diğer bilgiler bu alanda verilecektir.</p>
                    </div>
                    <div class="tab-pane fade" id="pills-payment" role="tabpanel" aria-labelledby="pills-payment-tab">
                        <p>Burada kabul edilen ödeme yöntemleri hakkında bilgi verilecektir. Kredi kartı, banka havalesi gibi ödeme seçenekleri burada listelenecektir.</p>
                    </div>
                    <div class="tab-pane fade" id="pills-comment" role="tabpanel" aria-labelledby="pills-comment-tab">
                        <p>Diğer kullanıcıların ürün hakkında yazdığı yorumlar burada yer alacaktır. Kullanıcı yorumları ve puanlamalar burada gösterilecektir.</p>
                        <div id="commentsList">
                            <!-- Yorumlar burada görünecek -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        var productId = '@Model.Id'; // Get the product ID from the model

        // Sayfa yüklendiğinde yorumları yükle
        loadComments(productId);

        // Yorum formunu işleme
        document.getElementById('reviewForm').addEventListener('submit', function (event) {
            event.preventDefault();

            var firstName = document.getElementById('firstName').value;
            var lastName = document.getElementById('lastName').value;
            var reviewText = document.getElementById('reviewText').value;

            if (firstName.trim() !== '' && lastName.trim() !== '' && reviewText.trim() !== '') {
                var comments = JSON.parse(localStorage.getItem('comments')) || [];
                comments.push({
                    productId: productId,
                    firstName: firstName,
                    lastName: lastName,
                    reviewText: reviewText,
                    createdAt: new Date().toISOString()
                });
                localStorage.setItem('comments', JSON.stringify(comments));

                // Formu temizle
                document.getElementById('firstName').value = '';
                document.getElementById('lastName').value = '';
                document.getElementById('reviewText').value = '';

                // Modalı kapat
                $('#reviewModal').modal('hide');

                // Yorumları tekrar yükle
                loadComments(productId);
            }
        });
    });

    function loadComments(productId) {
        var commentsList = document.getElementById('commentsList');
        commentsList.innerHTML = '';

        var comments = JSON.parse(localStorage.getItem('comments')) || [];
        comments.filter(comment => comment.productId === productId).forEach(function (comment) {
            var commentDiv = document.createElement('div');
            commentDiv.className = 'comment';
            commentDiv.innerHTML = '<strong>' + comment.firstName + ' ' + comment.lastName + '</strong><p>' + comment.reviewText + '</p><small>' + new Date(comment.createdAt).toLocaleString() + '</small>';
            commentsList.appendChild(commentDiv);
        });
    }

</script>


<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js"></script>
